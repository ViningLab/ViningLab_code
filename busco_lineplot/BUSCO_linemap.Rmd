---
title: "BUSCO linemap"
output: html_document
date: "2023-08-08"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


- https://tidyr.tidyverse.org/articles/pivot.html
- https://posit.co/resources/cheatsheets/


## DM6


```{r}
dm6 <- read.table("DM6_full_table.tsv", header = FALSE, sep = "\t", fill = TRUE)
names(dm6) <- c("Busco_id", "Status", "Sequence", "Gene_Start", "Gene_End", "Strand", "Score", "Length")
dm6[1:3, ]
table(dm6$Status)

dm6 <- dm6 |> dplyr::filter( Status == "Complete")
table(dm6$Status)
```


## DM4


```{r}
dm4 <- read.table("DM4_full_table.tsv", header = FALSE, sep = "\t", fill = TRUE)
names(dm4) <- c("Busco_id", "Status", "Sequence", "Gene_Start", "Gene_End", "Strand", "Score", "Length")
dm4[1:3, ]

dm4 <- dm4 |> dplyr::filter( Status == "Complete")
table(dm4$Status)

```


## Castle-Russet


```{r}
casr <- read.table("castle-russet_full_table.tsv", header = FALSE, sep = "\t", fill = TRUE)
names(casr) <- c("Busco_id", "Status", "Sequence", "Gene_Start", "Gene_End", "Strand", "Score", "Length")
table(casr$Status)

casr[1:3, ]
```



## chr3


```{r}

table(dm6$Sequence)
chr3 <- dm6[ dm6$Sequence == "chr03", ]

row.names(chr3) <- chr3$Busco_id
chr3[1:3, ]
chr3[c("265at71240", "383at71240"), ]


table(dm4$Sequence)
tmp <- dm4[ dm4$Sequence == "ST4.03ch03", ]
row.names(tmp) <- tmp$Busco_id
tmp[1:3, ]


tmp[ chr3$Busco_id[1:4], ]

chr3 <- cbind(chr3, tmp[ chr3$Busco_id, "Gene_Start"])
colnames(chr3)[ncol(chr3)] <- "dm4"
chr3[1:3, ]


```






## Line map


```{r}




```



## Plot 2


```{r}

busc <- chr3[, c(1, 4, 9)]
names(busc)[2] <- "dm6"


library(tidyr)
library(dplyr)
busc[1:3, ]

col_no <- 21
#rm(data_long)
#vars <- colnames(busc)[1:col_no]
vars <- colnames(busc)

#data_long <- busc[, 1:col_no] %>% 
#  pivot_longer( cols = 2:col_no )

data_long <- busc %>%
  select(all_of(vars)) %>% 
  pivot_longer( cols = vars[-1] )

names(data_long)[2:3] <- c("Sample", "POS")
data_long


library(ggplot2)
p <- ggplot(data_long, aes(x = Sample, y = POS, color = Busco_id, group = Busco_id)) + 
  geom_point( size = 1.2 ) +
  geom_line( linewidth = 0.8 )
p <- p + scale_color_manual( values = rep(viridisLite::magma( n = 8, alpha = 0.8 ), times = 1e6) )
p <- p + theme_bw()
#p <- p + xlab("")
p <- p + ylab("Position (Mbp)")
p <- p + theme(legend.position = "none")
p <- p + theme(axis.title.x = element_blank(), 
               axis.text.x = element_text(angle = 60, hjust = 1, size = 12))
p <- p + scale_y_continuous( breaks = seq(0, 1e9, by = 10e6),
                        labels = seq(0, 1e9, by = 10e6)/1e6,
                        minor_breaks = seq(0, 1e9, by = 5e6) )
p <- p + ggtitle( label = "BUSCO positions: Chromosome 3" )
```


```{r, fig.width=10, fig.height=6}
p
```





